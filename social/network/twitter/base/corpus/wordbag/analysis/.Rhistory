install.packages("pscl")
library(pscl)
cnts <- read.delim('twitter_experiments_head.tsv', header=F, sep='\t', colClasses=c("integer", "integer"))
cnts
hist(cnts$V1)
hist(cnts$V1/cnts$V2)
hist(cnts$V1/cnts$V2)
hist(as.float(cnts$V1)/cnts$V2)
cnts <- read.delim('twitter_experiments_head.tsv', header=F, sep='\t', colClasses=c("float", "float"))
?colClasses
??colClasses
??types
cnts <- read.delim('twitter_experiments_head.tsv', header=F, sep='\t', colClasses=c("double", "double"))
hist(cnts$V1/cnts$V2)
?zeroinfl
zeroinfl(f ~ cnts$V1/cnts$V2 | cnts$V2, dist="negbin", EM=TRUE) 
zeroinfl(cnts$V1 ~ cnts$V1/cnts$V2 | cnts$V2, dist="negbin", EM=TRUE) 
library(MASS)
glm.nb(cnts$V1 ~ cnts$V1/cnts$V2) 
library(VGAM)
library(vgam)
?vglm
install.packages("VGAM")
library(vgam)
library(VGAM)
?rzibinom
y = rzibinom(n=n, size=sv, prob=mubin, phi=phi) / sv # A proportion
mubin = logit(-1,inv=TRUE)
phi = logit(0,inv=TRUE)
y = rzibinom(n=200, size=10, prob=mubin, phi=phi) / 10 # A proportion
table(y)
y
plot(y)
plot(table(y))
?vglm
plot(table(y))
fr <- cnts$V1 / cnts$V2
fr
fit = vglm(fr ~ 1, zibinomial, trace=TRUE)
y
fit = vglm(cnts$V1 ~ 1, zibinomial, trace=TRUE)
fit = vglm(y ~ 1, zibinomial, trace=TRUE)
?zbinomial
??zbinomial
??zbinomial
?VGAM::zbinomial
?VGAM:zbinomial
sv = rep(size, len=n)
sv = rep(10, len=200)
sv
fit = vglm(cnts$V1 ~ 1, zibinomial, weight=cnts$V2, trace=TRUE)
y = rzibinom(n=200, size=10, prob=mubin, phi=phi) / sv # A proportion
y = rzibinom(n=200, size=sv, prob=mubin, phi=phi) / sv # A proportion
y
table(y)
plot(table(y))
fit = vglm(y ~ 1, zibinomial, weight=sv, trace=TRUE)
coef(fit)
summary(fit)
fit = vglm((cnts$V1/cnts$V2) ~ 1, zibinomial, weight=cnts$V2, trace=TRUE)
summary(fit)
?logit
Coef(fit)
source('beta_functions.r')
x <- seq(0,1,length=1000)
x
Coef(fit)["phi"]
Coef(fit)["mu"]
z <- Coef(fit)["phi"]
p <- Coef(fit)["mu"]
zbinom(x, z, p, 10000)
source('beta_functions.r')
zbinom
zibinom(x, z, p, 10000)
p
summary(p)
p.
as.numeric(p)
zibinom(x, as.numeric(z), as.numeric(p), 10000)
apply(x, FUN=zibinom(x, as.numeric(z), as.numeric(p), 10000))
?apply
apply(x, 1, FUN=zibinom(x, as.numeric(z), as.numeric(p), 10000))
apply(x, 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000)
apply(as.vector(x), 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000)
x
apply(x, 2, FUN=zibinom, as.numeric(z), as.numeric(p), 10000)
apply(x, 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000)
dim(x)
dim(x,1)
dim(as.matrix(x))
dim(as.vector(x))
as.matrix(x)
apply(as.matrix(x), 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000)
warnings()
source('beta_functions.r')
apply(as.matrix(x), 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000)
plot(apply(as.matrix(x), 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000))
hist(cnts$V1/cnts$V2, breaks=50)
hist(cnts$V1/cnts$V2, breaks=50, freq=F)
plot(apply(as.matrix(x), 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000))
cnts <- read.delim('the_experiments.tsv', header=F, sep='\t', colClasses=c("double", "double"))
cnts
fr <- cnts$V1 / cnts$V2
fr
fit = vglm((cnts$V1/cnts$V2) ~ 1, zibinomial, weight=cnts$V2, trace=TRUE)
library(VGAM)
fit = vglm((cnts$V1/cnts$V2) ~ 1, zibinomial, weight=cnts$V2, trace=TRUE)
Coef(fit)["phi"]
Coef(fit)["mu"]
z <- Coef(fit)["phi"]
p <- Coef(fit)["mu"]
x <- seq(0,1,length=1000)
source('beta_functions.r')
plot(apply(as.matrix(x), 1, FUN=zibinom, as.numeric(z), as.numeric(p), 10000))
hist(fr)
hist(fr, breaks=100)
library(pscl)
zeroinfl(fr ~ 1, dist="poisson")
?density
hist(fr, breaks=100)
lines(density(fr))
hist(fr, breaks=100, freq=F)
lines(density(fr), col="red")
summary(density)
Coef(density)
Coef(density(fr))
density(fr)
source('beta_functions.r')
beta_mu_rho <- function(x, mu, rho) {
  u = mu
  c = (1.0/rho) - 1.0
  return (beta_uc(x, u, c))
}
x = seq(0,1, len=1000)
??beta
?beta
beta.ab
?beta.ab
library(VGAM)
fit = vlgm(fr ~ 1, beta.ab)
fit = vglm(fr ~ 1, beta.ab)
coef(fit)
Coef(fit)
?beta.ab
fit = vglm(fr ~ 1, betabin.ab)
fit = vglm(cbind(cnts$V1, cnts$V2-cnts$V1), betabin.ab)
fit = vglm(cbind(cnts$V1, cnts$V2-cnts$V1) ~ 1, betabin.ab)
fit = vglm(cbind(cnts$V1, cnts$V2-cnts$V1) ~ 1, betabin.ab, trace=TRUE)
fit = vglm(cbind(cnts$V1, cnts$V2-cnts$V1) ~ 1, betabinomial, trace=TRUE)
fit = vglm(cbind(cnts$V1, cnts$V2-cnts$V1) ~ 1, betaff, trace=TRUE)
fit = vglm(fr ~ 1, betaff, trace=TRUE)
Coef(fit)
paj <- read.table('pajamas.tsv', header=F, sep='\t')
paj
hist(paj$V1/paj$V2)
hist(paj$V1/paj$V2, breaks=200)
paj <- read.table('pajamas_filtered.tsv', header=F, sep='\t')
hist(paj$V1/paj$V2, breaks=200)
library(VGAM)
fit = vglm(paj$V1/paj$V2 ~ 1, beta.ab)
Coef(fit)
?beta.ab
?beta
?betabin
?/beta.ab
??beta.ab
?beta.ab
?Beta
?Beta
x <- seq(0,1,len=1000)
dbeta(x, 0.0670841, 1158.7549297)
plot(dbeta(x, 0.0670841, 1158.7549297))
plot(x, dbeta(x, 0.0670841, 1158.7549297))
plot(x, rbeta(x, 0.0670841, 1158.7549297))
plot(x, pbeta(x, 0.0670841, 1158.7549297))
hist(paj$V1/paj$V2, breaks=200)
hist(paj$V1/paj$V2, breaks=200, freq=F)
lines(x, dbeta(x, 0.0670841, 1158.7549297))
lines(x, dbeta(x, 0.0670841, 1158.7549297), col="red")
hist(paj$V1/paj$V2, breaks=200, freq=FALS)
hist(paj$V1/paj$V2, breaks=200, freq=FALSE)
lines(dbeta(x, 0.0670841, 1158.7549297), col="red")
lines(x, dbeta(x, 0.0670841, 1158.7549297), col="red")
point(x, dbeta(x, 0.0670841, 1158.7549297), col="red")
points(x, dbeta(x, 0.0670841, 1158.7549297), col="red")
points(x, dbeta(x, 1158.7549297, 0.0670841), col="red")
hist(paj$V1/paj$V2, breaks=200, freq=FALSE)
points(x, dbeta(x, 1158.7549297, 0.0670841), col="red")
hist(paj$V1/paj$V2, breaks=200, freq=FALSE)
?dbeta
points(x, qbeta(x, 0.0670841, 1158.7549297), col="red")
points(x, dbeta(x, 0.0670841, 1158.7549297), col="red")
paj <- read.table('pajamas_filtered.tsv', header=F, sep='\t')
hist(paj$V1/paj$V2, breaks=200, freq=FALSE)
library(VGAM)
fit = vglm(paj$V1/paj$V2 ~ 1, beta.ab)
points(x, dbeta(x, Coef(fit)["shape1"], Coef(fit)["shape2"]), col="red")
lines(x, dbeta(x, Coef(fit)["shape1"], Coef(fit)["shape2"]), col="red")
paj <- read.table('pajamas_filtered.tsv', header=F, sep='\t')
fit = vglm(paj$V1/paj$V2 ~ 1, beta.ab)
library(VGAM)
fit = vglm(paj$V1/paj$V2 ~ 1, beta.ab)
paj <- read.table('pajamas.tsv', header=F, sep='\t')
library(VGAM)
fit = vglm(paj$V1/paj$V2 ~ 1, beta.ab)
paj
paj$V1/paj$V2
fr <- paj$V1/paj$V2
fit = vglm(fr ~ 1, beta.ab)
fit = vglm(fr ~ 1, beta.ab, trace=TRUE)
fit = vglm(fr ~ 1.5, beta.ab, trace=TRUE)
fit = vglm(fr ~ 10, beta.ab, trace=TRUE)
fit = vglm(fr ~ 1, beta.ab, trace=TRUE)
fit = vglm(fkaljlk ~ 1, beta.ab, trace=TRUE)
fit = vglm(fr ~ 1.0, beta.ab, trace=TRUE)
data
fit = vglm(fr ~ 1.0, beta.ab, trace=TRUE)
fr
max(fr)
fit = vglm(fr ~ 1.1, beta.ab, trace=TRUE)
fit = vglm(fr ~ 1, beta.ab, trace=TRUE)
paj <- read.table('pajamas_filtered.tsv', header=F, sep='\t')
library(VGAM)
fr <- paj$V1/paj$V2
fit = vglm(fr ~ 1, beta.ab, trace=TRUE)
fit = vglm(fr ~ 1, beta.ab)
hist(paj$V1/paj$V2, breaks=200, freq=FALSE)
points(x, dbeta(x, Coef(fit)["shape1"], Coef(fit)["shape2"]), col="red")
lines(x, dbeta(x, Coef(fit)["shape1"], Coef(fit)["shape2"]), col="red")
library(VGAM)
?beta.ab
d <- read.table(
d <- read.table('abrir.tsv', header=F, sep='\t')
hist(d$V1)
